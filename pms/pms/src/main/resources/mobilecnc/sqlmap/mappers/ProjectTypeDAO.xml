<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- Chamroeun -->

<mapper namespace="com.mobilecnc.projectTypes.service.ProjectTypeDAO">

	<resultMap id="projectType" type="ProjectType">
		<result property="projectTypeID" column="projectTypeID" />
		<result property="projectTypeName" column="projectTypeName" />
		<result property="billable" column="billable" />
		<result property="description" column="description" />
		<result property="entryDate" column="entryDate" />
		<result property="entryBy" column="entryBy" />
		<result property="lastModifyDate" column="lastModifyDate" />
		<result property="lastModifyBy" column="lastModifyBy" />
	</resultMap>

	<resultMap id="projectTypeList" type="ProjectType">
        <result property="projectTypeID" column="projectTypeID"/>
		<result property="projectTypeName" column="projectTypeName"/>
    </resultMap>
	
	<select id="selectProjectTypeList" resultMap="projectTypeList">  
		<![CDATA[	
			SELECT projectTypeID, projectTypeName FROM ProjectTypes
		]]>
	</select>

	<select id="getAllProjectTypes" resultMap="projectType"> 
		SELECT * FROM ProjectTypes;
	</select>

	<insert id="insertProjectType">
		<![CDATA[
			INSERT INTO ProjectTypes 
			(projectTypeID, projectTypeName, billable, description, entryDate, entryBy, lastModifyDate, lastModifyBy)
			VALUES
			(#{projectTypeID}, #{projectTypeName}, #{billable}, #{description}, getdate(), #{entryBy}, getDate(), #{entryBy});
		]]>
	</insert>

	<update id="updateProjectType" parameterType="ProjectType"> 
		<![CDATA[ 
			UPDATE ProjectTypes 
			SET 
				projectTypeName = #{projectTypeName}, 
				billable = #{billable},
				description = #{description}, 
				lastModifyDate = getdate(), 
				lastModifyBy = #{lastModifyBy} 
			WHERE projectTypeID = #{projectTypeID};
		]]>
	</update>

	<select id="deleteProjectType" parameterType="String">
		<![CDATA[
			DELETE FROM ProjectTypes
			WHERE projectTypeID = #{projectTypeID};
		]]>
	</select>

	<select id="getProjectType" parameterType="String" resultMap="projectType">
	<![CDATA[
		SELECT *
		FROM ProjectTypes
		WHERE projectTypeID = #{projectTypeID};
	]]>
	</select>

	<select id="getPagingRecord" resultMap="projectType"
		parameterType="com.mobilecnc.helper.PagingCondition">
		SELECT * FROM
		(SELECT ROW_NUMBER() OVER (ORDER BY projectTypeID) RowNr, projectTypeID, projectTypeName, billable, description, entryDate, entryBy, lastModifyDate, lastModifyBy
		FROM ProjectTypes 
		<where>
			<if test="col != null">
				${where}
			</if>
		</where>
		) AS VTables
		WHERE RowNr BETWEEN #{start} AND #{end}
		ORDER BY ${sidx} ${sord}
	</select>

	<select id="getRecordCount" resultType="int"
		parameterType="com.mobilecnc.helper.PagingCondition">
		SELECT COUNT(projectTypeID) FROM ProjectTypes
		<where>
			<if test="#{col} != null">
				${col} ${oper} ${val}
			</if>
		</where>
	</select>

	<!-- 0 is valid -->
	<select id="checkExistName" parameterType="ProjectType" resultType="int">
		<![CDATA[
			SELECT COUNT(projectTypeName)
			FROM ProjectTypes
			WHERE projectTypeID <> #{projectTypeID} AND projectTypeName LIKE #{projectTypeName};
		]]>
	</select>

</mapper>